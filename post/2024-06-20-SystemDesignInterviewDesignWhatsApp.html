<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><title>시스템 디자인 면접 WhatsApp 디자인하기 | design-news</title><meta name="description" content=""/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:url" content="https://design-news.github.io///post/2024-06-20-SystemDesignInterviewDesignWhatsApp" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:site_name" content="시스템 디자인 면접 WhatsApp 디자인하기 | design-news" data-gatsby-head="true"/><meta property="og:title" content="시스템 디자인 면접 WhatsApp 디자인하기 | design-news" data-gatsby-head="true"/><meta property="og:description" content="" data-gatsby-head="true"/><meta property="og:image" content="/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_0.png" data-gatsby-head="true"/><meta property="og:locale" content="en_US" data-gatsby-head="true"/><meta name="twitter:card" content="summary_large_image" data-gatsby-head="true"/><meta property="twitter:domain" content="https://design-news.github.io/" data-gatsby-head="true"/><meta property="twitter:url" content="https://design-news.github.io///post/2024-06-20-SystemDesignInterviewDesignWhatsApp" data-gatsby-head="true"/><meta name="twitter:title" content="시스템 디자인 면접 WhatsApp 디자인하기 | design-news" data-gatsby-head="true"/><meta name="twitter:description" content="" data-gatsby-head="true"/><meta name="twitter:image" content="/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_0.png" data-gatsby-head="true"/><meta name="twitter:data1" content="Dev | design-news" data-gatsby-head="true"/><meta name="article:published_time" content="2024-06-20 03:49" data-gatsby-head="true"/><meta name="next-head-count" content="19"/><meta name="google-site-verification" content="a-yehRo3k3xv7fg6LqRaE8jlE42e5wP2bDE_2F849O4"/><link rel="stylesheet" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/assets/favicons/favicon-96x96.png"/><link rel="icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-icon" href="/favicons/apple-icon-180x180.png"/><link rel="apple-touch-startup-image" href="/startup.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="msapplication-config" content="/favicons/browserconfig.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-V5DKFTZ6BX"></script><script>window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
          
            gtag('config', 'G-V5DKFTZ6BX');</script><link rel="preload" href="/_next/static/css/6e57edcf9f2ce551.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6e57edcf9f2ce551.css" data-n-g=""/><link rel="preload" href="/_next/static/css/acd99c507555fdc6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/acd99c507555fdc6.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee6df16fdc6dae4d.js" defer=""></script><script src="/_next/static/chunks/framework-46611630e39cfdeb.js" defer=""></script><script src="/_next/static/chunks/main-cf4a52eec9a970a0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6fae11262ee5c69b.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-ac4aa08aae62f90e.js" defer=""></script><script src="/_next/static/chunks/463-0429087d4c0b0335.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-3b19b133b17efefe.js" defer=""></script><script src="/_next/static/eK_Db2btow8fB-QoZ_pMH/_buildManifest.js" defer=""></script><script src="/_next/static/eK_Db2btow8fB-QoZ_pMH/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header class="Header_header__Z8PUO"><div class="Header_inner__tfr0u"><strong class="Header_title__Otn70"><a href="/">Design News</a></strong><nav class="Header_nav_area__6KVpk"><a class="nav_item" href="/posts/1">Posts</a></nav></div></header><main class="posts_container__NyRU3"><div class="posts_inner__i3n_i"><h1 class="posts_post_title__EbxNx">시스템 디자인 면접 WhatsApp 디자인하기</h1><div class="posts_meta__cR7lu"><div class="posts_profile_wrap__mslMl"><div class="posts_profile_image_wrap__kPikV"><img alt="시스템 디자인 면접 WhatsApp 디자인하기" loading="lazy" width="44" height="44" decoding="async" data-nimg="1" class="profile" style="color:transparent" src="/favicons/apple-icon-114x114.png"/></div><div class="posts_textarea__w_iKT"><span class="writer">Design News</span><span class="posts_info__5KJdN"><span class="posts_date__ctqHI">Posted On Jun 20, 2024</span><span class="posts_reading_time__f7YPP">5<!-- --> min read</span></span></div></div><img alt="" loading="lazy" width="50" height="50" decoding="async" data-nimg="1" class="posts_view_badge__tcbfm" style="color:transparent" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fallround-coder.github.io/post/2024-06-20-SystemDesignInterviewDesignWhatsApp&amp;count_bg=%2379C83D&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=views&amp;edge_flat=false"/></div><article class="posts_post_content__n_L6j"><div><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
</head>
<body>
<img src="/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_0.png">
<p>이 시스템 디자인 인터뷰 시나리오에서는 WhatsApp과 유사한 메시징 앱을 설계하라는 요청을 받았습니다.</p>
<p>실제 인터뷰에서는 앱의 하나 이상의 기능에 초점을 맞출 수 있지만, 이 기사에서는 시스템 구조에 대한 고수준 개요를 살펴보고, 필요한 경우 특정 영역을 더 깊게 탐구할 수 있습니다.</p>
<h1>기능 요구 사항 명확히하기</h1>
<div class="content-ad"></div>
<p>인터뷰어에게 몇 가지 질문으로 범위를 좁히겠습니다. 1시간 안에 전체 WhatsApp 플랫폼을 설계하는 것은 현실적이지 않습니다:</p>
<p><img src="/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_1.png" alt="WhatsApp Design Image"></p>
<ul>
<li>주요 사용 사례: 앱의 기본 목적은 메시지를 보내고 확인하고 수신하며 메시지를 읽고 읽은 것으로 표시하는 것입니다.</li>
<li>그룹: 그룹 메시징은 다루지 않겠습니다. 일대일 메시징만 다룰 것입니다.</li>
<li>콘텐츠 유형: 텍스트 메시지만 지원하며 이미지나 비디오는 지원하지 않을 것입니다.</li>
</ul>
<h1>비기능 요구사항 명확히하기</h1>
<div class="content-ad"></div>
<p>규모: 먼저, 규모에 대해 이야기해 보겠습니다. 시스템의 크기와 처리할 메시지의 양을 의미합니다. 매일 100억 건의 메시지가 전송된다고 가정하고, 1년 내에 그 양을 두 배로 늘리려고 합니다.</p>
<p><img src="/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_2.png" alt="System Design Interview Design WhatsApp"></p>
<p>가용성: 가용성 측면에서, 시스템이 항상 사용 가능하고 작동 중이어야 합니다.</p>
<p>지연 시간: 시스템의 지연 시간에 대해, 거의 즉시 발생하도록 원합니다. 대부분의 API 요청이 100ms 내에 완료되어야 합니다.</p>
<div class="content-ad"></div>
<h1>추정: 데이터 수학</h1>
<p>매일 100억 건의 메시지가 있으므로 매 초 약 10억 메시지 / 86,400초 = 초당 115,740개의 메시지 (MPS)가 있습니다. 1년 내에 두 배로 증가한다는 것은 우리가 115,740 * 2 = 231,480 MPS에 대비해야 한다는 것을 의미합니다.</p>
<p>메시지당 200바이트를 가정하면, 매일 저장해야 하는 용량은 100억 메시지 * 200바이트 = 2 테라바이트 (TB)입니다. 그리고 성장을 고려한 연간 저장 용량은 약 2TB * 365일 * 2 = 1.5 페타바이트 (PB)입니다.</p>
<p><img src="/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_3.png" alt="이미지"></p>
<div class="content-ad"></div>
<p>중요한 점은 평균을 계산했지만, 시스템은 평균 MPS보다 훨씬 높은 피크 트래픽을 처리해야 할 수도 있다는 것입니다. 피크 시간에 따라 확장이 필요할 수 있습니다.</p>
<h1>고수준 API 설계</h1>
<p>보다 넓은 호환성을 위해 대부분 RESTful API 스타일을 사용할 것으로 예상됩니다. 가능한 Endpoints에 대한 분해는 다음과 같습니다:</p>
<ul>
<li>메시지 전송 (POST /messages): 요청 본문에 수신자 ID와 메시지 내용이 포함됩니다. 성공 응답(200)은 고유한 메시지 식별자를 반환합니다. 오류 코드(400, 500)는 누락된 매개변수나 서버 문제를 처리합니다.</li>
<li>새 메시지 확인 (GET /messages): 응답은 읽지 않은 메시지의 배열이 포함된 200이거나 없을 경우 204입니다.</li>
<li>특정 메시지 확인 (GET /messages/:messageId): 특정 메시지를 반환합니다(200) 또는 찾을 수 없는 경우 404를 반환합니다.</li>
<li>메시지를 읽음으로 표시 (PUT 또는 PATCH /messages/:messageId): 성공 응답(200)은 변경을 확인하고, 404는 메시지를 찾을 수 없음을 나타냅니다.</li>
</ul>
<div class="content-ad"></div>
<p><img src="/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_4.png" alt="Table"></p>
<p>추가 고려 사항: 실시간 업데이트를 위해 웹소켓을 통합할 것입니다. API는 인증 및 초기 연결 설정을 처리할 것이며, '새 메시지 확인' 엔드포인트에 대한 페이징이 필요할 수 있습니다. 입력 유효성 검사와 같은 보안 조치도 필요합니다.</p>
<h1>고수준 시스템 디자인</h1>
<p>모바일 앱: 사용자의 기본 인터페이스는 모바일 앱(iOS, Android)입니다. 이 앱은 메시지 보내기 및 받기, 연락처 관리, 대화를 처리합니다.</p>
<div class="content-ad"></div>
<p>로드 밸런서: 들어오는 요청을 효율적으로 처리하기 위해 여러 서버에 트래픽을 분배하는 로드 밸런서를 사용할 것입니다. 이렇게 함으로써 응용 프로그램의 신뢰성이 향상됩니다.</p>
<p><img src="/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_5.png" alt=""></p>
<p>API 서버: 모든 요청은 우리가 이전에 개요를 설명한 RESTful API를 처리하는 API 서버로 전송됩니다. 메시징 로직을 관리합니다. API 서버 자체는 상태를 가지지 않을 수 있습니다. 이렇게 하면 트래픽이 증가함에 따라 (서버를 추가하여) 수평으로 확장할 수 있습니다.</p>
<p>WebSocket 연결: WhatsApp과 유사한 앱은 실시간 통신을 위해 웹소켓에 크게 의존합니다. 채팅 서버들은 모바일 앱과 지속적인 웹소켓 연결을 유지할 것입니다. 메시지가 도착하면 즉시 수신자의 기기로 푸시될 수 있습니다.</p>
<div class="content-ad"></div>
<p>메시지 분배자: 다음으로 메시지 분배자 서비스가 준비되어 있습니다. 이 서비스의 주요 목적은 API 서버를 직접적인 데이터베이스 쓰기로부터 분리하는 것입니다. 특히 높은 쓰기 부하를 처리하는 데 중요합니다.</p>
<p><img src="/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_6.png" alt="이미지"></p>
<p>여기에 메시지 대기열인 Kafka 또는 RabbitMQ가 잘 맞습니다. 다음은 작동 방식입니다:</p>
<ul>
<li>API 서버가 "메시지 보내기" POST 요청을 받습니다.</li>
<li>이는 메시지를 대기열에 넣고 즉시 클라이언트에 성공/확인 응답을 반환합니다.</li>
<li>별도의 워커 프로세스가 대기열에서 비동기적으로 읽고 메시지를 데이터베이스에 작성합니다.</li>
</ul>
<div class="content-ad"></div>
<pre><code>데이터베이스 (NoSQL): 우리는 최종 일관성이 허용 가능하다고 합의했고, 이것은 NoSQL을 고대로 메시지 양에 대해 확장 가능한 선택으로 만듭니다.

두 가지 강력한 옵션을 고려해 봅시다:

- Cassandra: 확장 가능성, 고가용성 및 기록 성능으로 유명한 와이드 컬럼 스토어. 특히 ID로 메시지 검색하는 간단한 패턴을 예상할 경우 (주로 ID로 메시지 가져오기) 매우 유용합니다.
- DynamoDB: AWS에서 제공하는 완전히 관리되는 키-값 및 문서 데이터베이스. 우리가 쉽게 확장 가능한 최소 유지 관리 데이터베이스 솔루션을 원할 경우 유리합니다.

&#x3C;img src="/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_7.png" />
</code></pre>
<div class="content-ad"></div>
<p>샤딩 및 분할: 1.5 페타바이트 저장 공간이 필요하기 때문에 단일 데이터베이스로는 처리할 수 없으므로 데이터를 샤딩(수평 분할)하는 것이 중요합니다.</p>
<p>하지만 이 데이터를 어떻게 샤딩하고 분할하며, API 서버들은 이 데이터를 어디에서 요청해야 하는지 어떻게 알 수 있을까요?</p>
<p>유저 ID를 기반으로 분할할 수 있습니다. 한 유저와 관련된 모든 메시지는 동일한 샤드/분할에 저장됩니다. 그리고 API 서버들은 데이터를 찾는 두 가지 방법이 있습니다:</p>
<div class="content-ad"></div>
<pre><code>![2024-06-20-SystemDesignInterviewDesignWhatsApp_9.png](/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_9.png)

- Consistent Hashing Ring: 파티션 키를 기반으로 데이터 위치를 결정하여 API 서버가 올바른 데이터베이스 샤드로 요청을 직접 라우팅할 수 있습니다.
- 메타데이터 서비스: 별도의 서비스가 파티션 키와 샤드 위치의 매핑을 유지합니다. API 서버는 먼저 이 서비스를 쿼리한 다음 데이터베이스 호출을 수행합니다.

# 결론 및 현재 시스템 병목 현상

이것은 WhatsApp과 유사한 응용 프로그램을 위한 주요 아키텍처를 개략적으로 소개합니다. 이제 현재 시스템의 잠재적인 병목 현상과 개선할 수 있는 부분을 살펴보겠습니다.
</code></pre>
<div class="content-ad"></div>
<ul>
<li>데이터베이스 쓰기: 높은 쓰기 양은 잠재적인 병목 현상이 될 수 있습니다. Sharding, 메시지 대기열 및 최적화된 데이터베이스 선택이 중요합니다.</li>
<li>엔드 투 엔드 암호화: WhatsApp 모델은 보안을 강조합니다. 엔드 투 엔드 암호화를 구현하는 것은 중요한 논의가 될 것입니다.</li>
<li>그룹 채팅: 이 기능은 메시지 라우팅 및 저장에 추가 복잡성을 불러옵니다.</li>
<li>미디어 처리: 이미지 및 비디오 업로드를 처리하는 시스템을 구현할 수 있습니다. 압축을 사용하는 것과 썸네일을 위한 여러 저장 크기를 사용할 수 있습니다.</li>
</ul>
<p>만약 여기서 논의한 각 구성 요소에 대해 더 알고 싶다면, 상세한 내용을 다루는 무료 시스템 디자인 면접 개념 튜토리얼이 있습니다.</p>
</body>
</html>
</div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"시스템 디자인 면접 WhatsApp 디자인하기","description":"","date":"2024-06-20 03:49","slug":"2024-06-20-SystemDesignInterviewDesignWhatsApp","content":"\n\n\u003cimg src=\"/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_0.png\" /\u003e\n\n이 시스템 디자인 인터뷰 시나리오에서는 WhatsApp과 유사한 메시징 앱을 설계하라는 요청을 받았습니다.\n\n실제 인터뷰에서는 앱의 하나 이상의 기능에 초점을 맞출 수 있지만, 이 기사에서는 시스템 구조에 대한 고수준 개요를 살펴보고, 필요한 경우 특정 영역을 더 깊게 탐구할 수 있습니다.\n\n# 기능 요구 사항 명확히하기\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n인터뷰어에게 몇 가지 질문으로 범위를 좁히겠습니다. 1시간 안에 전체 WhatsApp 플랫폼을 설계하는 것은 현실적이지 않습니다:\n\n![WhatsApp Design Image](/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_1.png)\n\n- 주요 사용 사례: 앱의 기본 목적은 메시지를 보내고 확인하고 수신하며 메시지를 읽고 읽은 것으로 표시하는 것입니다.\n- 그룹: 그룹 메시징은 다루지 않겠습니다. 일대일 메시징만 다룰 것입니다.\n- 콘텐츠 유형: 텍스트 메시지만 지원하며 이미지나 비디오는 지원하지 않을 것입니다.\n\n# 비기능 요구사항 명확히하기\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n규모: 먼저, 규모에 대해 이야기해 보겠습니다. 시스템의 크기와 처리할 메시지의 양을 의미합니다. 매일 100억 건의 메시지가 전송된다고 가정하고, 1년 내에 그 양을 두 배로 늘리려고 합니다.\n\n![System Design Interview Design WhatsApp](/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_2.png)\n\n가용성: 가용성 측면에서, 시스템이 항상 사용 가능하고 작동 중이어야 합니다.\n\n지연 시간: 시스템의 지연 시간에 대해, 거의 즉시 발생하도록 원합니다. 대부분의 API 요청이 100ms 내에 완료되어야 합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n# 추정: 데이터 수학\n\n매일 100억 건의 메시지가 있으므로 매 초 약 10억 메시지 / 86,400초 = 초당 115,740개의 메시지 (MPS)가 있습니다. 1년 내에 두 배로 증가한다는 것은 우리가 115,740 * 2 = 231,480 MPS에 대비해야 한다는 것을 의미합니다.\n\n메시지당 200바이트를 가정하면, 매일 저장해야 하는 용량은 100억 메시지 * 200바이트 = 2 테라바이트 (TB)입니다. 그리고 성장을 고려한 연간 저장 용량은 약 2TB * 365일 * 2 = 1.5 페타바이트 (PB)입니다.\n\n![이미지](/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_3.png)\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n중요한 점은 평균을 계산했지만, 시스템은 평균 MPS보다 훨씬 높은 피크 트래픽을 처리해야 할 수도 있다는 것입니다. 피크 시간에 따라 확장이 필요할 수 있습니다.\n\n# 고수준 API 설계\n\n보다 넓은 호환성을 위해 대부분 RESTful API 스타일을 사용할 것으로 예상됩니다. 가능한 Endpoints에 대한 분해는 다음과 같습니다:\n\n- 메시지 전송 (POST /messages): 요청 본문에 수신자 ID와 메시지 내용이 포함됩니다. 성공 응답(200)은 고유한 메시지 식별자를 반환합니다. 오류 코드(400, 500)는 누락된 매개변수나 서버 문제를 처리합니다.\n- 새 메시지 확인 (GET /messages): 응답은 읽지 않은 메시지의 배열이 포함된 200이거나 없을 경우 204입니다.\n- 특정 메시지 확인 (GET /messages/:messageId): 특정 메시지를 반환합니다(200) 또는 찾을 수 없는 경우 404를 반환합니다.\n- 메시지를 읽음으로 표시 (PUT 또는 PATCH /messages/:messageId): 성공 응답(200)은 변경을 확인하고, 404는 메시지를 찾을 수 없음을 나타냅니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n![Table](/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_4.png)\n\n추가 고려 사항: 실시간 업데이트를 위해 웹소켓을 통합할 것입니다. API는 인증 및 초기 연결 설정을 처리할 것이며, '새 메시지 확인' 엔드포인트에 대한 페이징이 필요할 수 있습니다. 입력 유효성 검사와 같은 보안 조치도 필요합니다.\n\n# 고수준 시스템 디자인\n\n모바일 앱: 사용자의 기본 인터페이스는 모바일 앱(iOS, Android)입니다. 이 앱은 메시지 보내기 및 받기, 연락처 관리, 대화를 처리합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n로드 밸런서: 들어오는 요청을 효율적으로 처리하기 위해 여러 서버에 트래픽을 분배하는 로드 밸런서를 사용할 것입니다. 이렇게 함으로써 응용 프로그램의 신뢰성이 향상됩니다.\n\n![](/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_5.png)\n\nAPI 서버: 모든 요청은 우리가 이전에 개요를 설명한 RESTful API를 처리하는 API 서버로 전송됩니다. 메시징 로직을 관리합니다. API 서버 자체는 상태를 가지지 않을 수 있습니다. 이렇게 하면 트래픽이 증가함에 따라 (서버를 추가하여) 수평으로 확장할 수 있습니다.\n\nWebSocket 연결: WhatsApp과 유사한 앱은 실시간 통신을 위해 웹소켓에 크게 의존합니다. 채팅 서버들은 모바일 앱과 지속적인 웹소켓 연결을 유지할 것입니다. 메시지가 도착하면 즉시 수신자의 기기로 푸시될 수 있습니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n메시지 분배자: 다음으로 메시지 분배자 서비스가 준비되어 있습니다. 이 서비스의 주요 목적은 API 서버를 직접적인 데이터베이스 쓰기로부터 분리하는 것입니다. 특히 높은 쓰기 부하를 처리하는 데 중요합니다.\n\n![이미지](/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_6.png)\n\n여기에 메시지 대기열인 Kafka 또는 RabbitMQ가 잘 맞습니다. 다음은 작동 방식입니다:\n\n- API 서버가 \"메시지 보내기\" POST 요청을 받습니다.\n- 이는 메시지를 대기열에 넣고 즉시 클라이언트에 성공/확인 응답을 반환합니다.\n- 별도의 워커 프로세스가 대기열에서 비동기적으로 읽고 메시지를 데이터베이스에 작성합니다.\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```\n데이터베이스 (NoSQL): 우리는 최종 일관성이 허용 가능하다고 합의했고, 이것은 NoSQL을 고대로 메시지 양에 대해 확장 가능한 선택으로 만듭니다.\n\n두 가지 강력한 옵션을 고려해 봅시다:\n\n- Cassandra: 확장 가능성, 고가용성 및 기록 성능으로 유명한 와이드 컬럼 스토어. 특히 ID로 메시지 검색하는 간단한 패턴을 예상할 경우 (주로 ID로 메시지 가져오기) 매우 유용합니다.\n- DynamoDB: AWS에서 제공하는 완전히 관리되는 키-값 및 문서 데이터베이스. 우리가 쉽게 확장 가능한 최소 유지 관리 데이터베이스 솔루션을 원할 경우 유리합니다.\n\n\u003cimg src=\"/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_7.png\" /\u003e\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n샤딩 및 분할: 1.5 페타바이트 저장 공간이 필요하기 때문에 단일 데이터베이스로는 처리할 수 없으므로 데이터를 샤딩(수평 분할)하는 것이 중요합니다.\n\n하지만 이 데이터를 어떻게 샤딩하고 분할하며, API 서버들은 이 데이터를 어디에서 요청해야 하는지 어떻게 알 수 있을까요?\n\n유저 ID를 기반으로 분할할 수 있습니다. 한 유저와 관련된 모든 메시지는 동일한 샤드/분할에 저장됩니다. 그리고 API 서버들은 데이터를 찾는 두 가지 방법이 있습니다:\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n```\n![2024-06-20-SystemDesignInterviewDesignWhatsApp_9.png](/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_9.png)\n\n- Consistent Hashing Ring: 파티션 키를 기반으로 데이터 위치를 결정하여 API 서버가 올바른 데이터베이스 샤드로 요청을 직접 라우팅할 수 있습니다.\n- 메타데이터 서비스: 별도의 서비스가 파티션 키와 샤드 위치의 매핑을 유지합니다. API 서버는 먼저 이 서비스를 쿼리한 다음 데이터베이스 호출을 수행합니다.\n\n# 결론 및 현재 시스템 병목 현상\n\n이것은 WhatsApp과 유사한 응용 프로그램을 위한 주요 아키텍처를 개략적으로 소개합니다. 이제 현재 시스템의 잠재적인 병목 현상과 개선할 수 있는 부분을 살펴보겠습니다.\n```\n\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\n- 데이터베이스 쓰기: 높은 쓰기 양은 잠재적인 병목 현상이 될 수 있습니다. Sharding, 메시지 대기열 및 최적화된 데이터베이스 선택이 중요합니다.\n- 엔드 투 엔드 암호화: WhatsApp 모델은 보안을 강조합니다. 엔드 투 엔드 암호화를 구현하는 것은 중요한 논의가 될 것입니다.\n- 그룹 채팅: 이 기능은 메시지 라우팅 및 저장에 추가 복잡성을 불러옵니다.\n- 미디어 처리: 이미지 및 비디오 업로드를 처리하는 시스템을 구현할 수 있습니다. 압축을 사용하는 것과 썸네일을 위한 여러 저장 크기를 사용할 수 있습니다.\n\n만약 여기서 논의한 각 구성 요소에 대해 더 알고 싶다면, 상세한 내용을 다루는 무료 시스템 디자인 면접 개념 튜토리얼이 있습니다.","ogImage":{"url":"/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_0.png"},"coverImage":"/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_0.png","tag":["Tech"],"readingTime":5},"content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003cmeta content=\"width=device-width, initial-scale=1\" name=\"viewport\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cimg src=\"/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_0.png\"\u003e\n\u003cp\u003e이 시스템 디자인 인터뷰 시나리오에서는 WhatsApp과 유사한 메시징 앱을 설계하라는 요청을 받았습니다.\u003c/p\u003e\n\u003cp\u003e실제 인터뷰에서는 앱의 하나 이상의 기능에 초점을 맞출 수 있지만, 이 기사에서는 시스템 구조에 대한 고수준 개요를 살펴보고, 필요한 경우 특정 영역을 더 깊게 탐구할 수 있습니다.\u003c/p\u003e\n\u003ch1\u003e기능 요구 사항 명확히하기\u003c/h1\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e인터뷰어에게 몇 가지 질문으로 범위를 좁히겠습니다. 1시간 안에 전체 WhatsApp 플랫폼을 설계하는 것은 현실적이지 않습니다:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_1.png\" alt=\"WhatsApp Design Image\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e주요 사용 사례: 앱의 기본 목적은 메시지를 보내고 확인하고 수신하며 메시지를 읽고 읽은 것으로 표시하는 것입니다.\u003c/li\u003e\n\u003cli\u003e그룹: 그룹 메시징은 다루지 않겠습니다. 일대일 메시징만 다룰 것입니다.\u003c/li\u003e\n\u003cli\u003e콘텐츠 유형: 텍스트 메시지만 지원하며 이미지나 비디오는 지원하지 않을 것입니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003e비기능 요구사항 명확히하기\u003c/h1\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e규모: 먼저, 규모에 대해 이야기해 보겠습니다. 시스템의 크기와 처리할 메시지의 양을 의미합니다. 매일 100억 건의 메시지가 전송된다고 가정하고, 1년 내에 그 양을 두 배로 늘리려고 합니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_2.png\" alt=\"System Design Interview Design WhatsApp\"\u003e\u003c/p\u003e\n\u003cp\u003e가용성: 가용성 측면에서, 시스템이 항상 사용 가능하고 작동 중이어야 합니다.\u003c/p\u003e\n\u003cp\u003e지연 시간: 시스템의 지연 시간에 대해, 거의 즉시 발생하도록 원합니다. 대부분의 API 요청이 100ms 내에 완료되어야 합니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003ch1\u003e추정: 데이터 수학\u003c/h1\u003e\n\u003cp\u003e매일 100억 건의 메시지가 있으므로 매 초 약 10억 메시지 / 86,400초 = 초당 115,740개의 메시지 (MPS)가 있습니다. 1년 내에 두 배로 증가한다는 것은 우리가 115,740 * 2 = 231,480 MPS에 대비해야 한다는 것을 의미합니다.\u003c/p\u003e\n\u003cp\u003e메시지당 200바이트를 가정하면, 매일 저장해야 하는 용량은 100억 메시지 * 200바이트 = 2 테라바이트 (TB)입니다. 그리고 성장을 고려한 연간 저장 용량은 약 2TB * 365일 * 2 = 1.5 페타바이트 (PB)입니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_3.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e중요한 점은 평균을 계산했지만, 시스템은 평균 MPS보다 훨씬 높은 피크 트래픽을 처리해야 할 수도 있다는 것입니다. 피크 시간에 따라 확장이 필요할 수 있습니다.\u003c/p\u003e\n\u003ch1\u003e고수준 API 설계\u003c/h1\u003e\n\u003cp\u003e보다 넓은 호환성을 위해 대부분 RESTful API 스타일을 사용할 것으로 예상됩니다. 가능한 Endpoints에 대한 분해는 다음과 같습니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e메시지 전송 (POST /messages): 요청 본문에 수신자 ID와 메시지 내용이 포함됩니다. 성공 응답(200)은 고유한 메시지 식별자를 반환합니다. 오류 코드(400, 500)는 누락된 매개변수나 서버 문제를 처리합니다.\u003c/li\u003e\n\u003cli\u003e새 메시지 확인 (GET /messages): 응답은 읽지 않은 메시지의 배열이 포함된 200이거나 없을 경우 204입니다.\u003c/li\u003e\n\u003cli\u003e특정 메시지 확인 (GET /messages/:messageId): 특정 메시지를 반환합니다(200) 또는 찾을 수 없는 경우 404를 반환합니다.\u003c/li\u003e\n\u003cli\u003e메시지를 읽음으로 표시 (PUT 또는 PATCH /messages/:messageId): 성공 응답(200)은 변경을 확인하고, 404는 메시지를 찾을 수 없음을 나타냅니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_4.png\" alt=\"Table\"\u003e\u003c/p\u003e\n\u003cp\u003e추가 고려 사항: 실시간 업데이트를 위해 웹소켓을 통합할 것입니다. API는 인증 및 초기 연결 설정을 처리할 것이며, '새 메시지 확인' 엔드포인트에 대한 페이징이 필요할 수 있습니다. 입력 유효성 검사와 같은 보안 조치도 필요합니다.\u003c/p\u003e\n\u003ch1\u003e고수준 시스템 디자인\u003c/h1\u003e\n\u003cp\u003e모바일 앱: 사용자의 기본 인터페이스는 모바일 앱(iOS, Android)입니다. 이 앱은 메시지 보내기 및 받기, 연락처 관리, 대화를 처리합니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e로드 밸런서: 들어오는 요청을 효율적으로 처리하기 위해 여러 서버에 트래픽을 분배하는 로드 밸런서를 사용할 것입니다. 이렇게 함으로써 응용 프로그램의 신뢰성이 향상됩니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_5.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eAPI 서버: 모든 요청은 우리가 이전에 개요를 설명한 RESTful API를 처리하는 API 서버로 전송됩니다. 메시징 로직을 관리합니다. API 서버 자체는 상태를 가지지 않을 수 있습니다. 이렇게 하면 트래픽이 증가함에 따라 (서버를 추가하여) 수평으로 확장할 수 있습니다.\u003c/p\u003e\n\u003cp\u003eWebSocket 연결: WhatsApp과 유사한 앱은 실시간 통신을 위해 웹소켓에 크게 의존합니다. 채팅 서버들은 모바일 앱과 지속적인 웹소켓 연결을 유지할 것입니다. 메시지가 도착하면 즉시 수신자의 기기로 푸시될 수 있습니다.\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e메시지 분배자: 다음으로 메시지 분배자 서비스가 준비되어 있습니다. 이 서비스의 주요 목적은 API 서버를 직접적인 데이터베이스 쓰기로부터 분리하는 것입니다. 특히 높은 쓰기 부하를 처리하는 데 중요합니다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_6.png\" alt=\"이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e여기에 메시지 대기열인 Kafka 또는 RabbitMQ가 잘 맞습니다. 다음은 작동 방식입니다:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAPI 서버가 \"메시지 보내기\" POST 요청을 받습니다.\u003c/li\u003e\n\u003cli\u003e이는 메시지를 대기열에 넣고 즉시 클라이언트에 성공/확인 응답을 반환합니다.\u003c/li\u003e\n\u003cli\u003e별도의 워커 프로세스가 대기열에서 비동기적으로 읽고 메시지를 데이터베이스에 작성합니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode\u003e데이터베이스 (NoSQL): 우리는 최종 일관성이 허용 가능하다고 합의했고, 이것은 NoSQL을 고대로 메시지 양에 대해 확장 가능한 선택으로 만듭니다.\n\n두 가지 강력한 옵션을 고려해 봅시다:\n\n- Cassandra: 확장 가능성, 고가용성 및 기록 성능으로 유명한 와이드 컬럼 스토어. 특히 ID로 메시지 검색하는 간단한 패턴을 예상할 경우 (주로 ID로 메시지 가져오기) 매우 유용합니다.\n- DynamoDB: AWS에서 제공하는 완전히 관리되는 키-값 및 문서 데이터베이스. 우리가 쉽게 확장 가능한 최소 유지 관리 데이터베이스 솔루션을 원할 경우 유리합니다.\n\n\u0026#x3C;img src=\"/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_7.png\" /\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cp\u003e샤딩 및 분할: 1.5 페타바이트 저장 공간이 필요하기 때문에 단일 데이터베이스로는 처리할 수 없으므로 데이터를 샤딩(수평 분할)하는 것이 중요합니다.\u003c/p\u003e\n\u003cp\u003e하지만 이 데이터를 어떻게 샤딩하고 분할하며, API 서버들은 이 데이터를 어디에서 요청해야 하는지 어떻게 알 수 있을까요?\u003c/p\u003e\n\u003cp\u003e유저 ID를 기반으로 분할할 수 있습니다. 한 유저와 관련된 모든 메시지는 동일한 샤드/분할에 저장됩니다. 그리고 API 서버들은 데이터를 찾는 두 가지 방법이 있습니다:\u003c/p\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cpre\u003e\u003ccode\u003e![2024-06-20-SystemDesignInterviewDesignWhatsApp_9.png](/assets/img/2024-06-20-SystemDesignInterviewDesignWhatsApp_9.png)\n\n- Consistent Hashing Ring: 파티션 키를 기반으로 데이터 위치를 결정하여 API 서버가 올바른 데이터베이스 샤드로 요청을 직접 라우팅할 수 있습니다.\n- 메타데이터 서비스: 별도의 서비스가 파티션 키와 샤드 위치의 매핑을 유지합니다. API 서버는 먼저 이 서비스를 쿼리한 다음 데이터베이스 호출을 수행합니다.\n\n# 결론 및 현재 시스템 병목 현상\n\n이것은 WhatsApp과 유사한 응용 프로그램을 위한 주요 아키텍처를 개략적으로 소개합니다. 이제 현재 시스템의 잠재적인 병목 현상과 개선할 수 있는 부분을 살펴보겠습니다.\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"content-ad\"\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003e데이터베이스 쓰기: 높은 쓰기 양은 잠재적인 병목 현상이 될 수 있습니다. Sharding, 메시지 대기열 및 최적화된 데이터베이스 선택이 중요합니다.\u003c/li\u003e\n\u003cli\u003e엔드 투 엔드 암호화: WhatsApp 모델은 보안을 강조합니다. 엔드 투 엔드 암호화를 구현하는 것은 중요한 논의가 될 것입니다.\u003c/li\u003e\n\u003cli\u003e그룹 채팅: 이 기능은 메시지 라우팅 및 저장에 추가 복잡성을 불러옵니다.\u003c/li\u003e\n\u003cli\u003e미디어 처리: 이미지 및 비디오 업로드를 처리하는 시스템을 구현할 수 있습니다. 압축을 사용하는 것과 썸네일을 위한 여러 저장 크기를 사용할 수 있습니다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e만약 여기서 논의한 각 구성 요소에 대해 더 알고 싶다면, 상세한 내용을 다루는 무료 시스템 디자인 면접 개념 튜토리얼이 있습니다.\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"2024-06-20-SystemDesignInterviewDesignWhatsApp"},"buildId":"eK_Db2btow8fB-QoZ_pMH","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>